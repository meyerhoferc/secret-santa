<div class="dashboard-container">
  <% if current_user %>
    <div class="dashboard-title">
      <h1><%= "Welcome #{current_user.first_name || current_user.email}" %></h1>
    </div>

    <div class="dashboard-inv-grp">
      <% if !current_user.outstanding_invitations.empty? %>
      <div class="dashboard-invitations">
        <div class="dashboard-invitations-title">
          <h2>My Invitations</h2>
        </div>
        <div class="dashboard-invitations-inv">
          <% current_user.outstanding_invitations.each do |invitation| %>
            <% if invitation.accepted.nil? %>
              <div class="dashboard-invitations-each-invite">
                <p class="greeting">
                  <% user = User.find(invitation.sender_id) %>
                  <%= link_to "#{user.first_name} #{user.last_name}", user_path(invitation.sender_id) %><%= " has invited you to join the group "%><%= link_to "#{Group.find(invitation.group_id).name}!", group_path(invitation.group_id) %>
                </p>
                <% if invitation.comment %>
                  <p class="comment">
                    <%= invitation.comment %>
                  </p>
                <% end %>
                <p class="reply">
                  <%= link_to "Accept", accept_path(invitation.id)%> <%= link_to "Decline", decline_path(invitation.id)%>
                </p>
              </div>
            <% end %>
          <% end %>
        </div>
      </div>
      <% end %>
      <div class="dashboard-groups">
        <div class="dashboard-groups-title">
          <h2>My Groups</h2>
        </div>
        <div class="dashboard-groups-create">
          <%= link_to "Create a Group", new_group_path %>
        </div>
        <div class="dashboard-groups-grp">
          <% if !current_user.groups.empty? %>
            <%= render partial: 'users/groups', collection: current_user.groups.reorder('gift_due_date ASC') %>
          <% else %>
            You are not part of any groups.
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>
